(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{537:function(s,a,t){"use strict";t.r(a);var r=t(56),e=Object(r.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"容器内信息收集"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器内信息收集"}},[s._v("#")]),s._v(" 容器内信息收集")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E5%AE%B9%E5%99%A8%E5%86%85%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"}},[s._v("容器内信息收集")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#1-%E5%9F%BA%E7%A1%80%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF"}},[s._v("1. 基础系统信息")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#2-%E7%A3%81%E7%9B%98%E5%8F%8A%E6%8C%82%E8%BD%BD%E4%BF%A1%E6%81%AF"}},[s._v("2. 磁盘及挂载信息")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#3-%E6%98%AF%E5%90%A6%E4%B8%BA%E7%89%B9%E6%9D%83%E5%AE%B9%E5%99%A8"}},[s._v("3. 是否为特权容器")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#4-sidfiles"}},[s._v("4. SidFiles")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#5-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"}},[s._v("5. 环境变量")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#6-capabilities"}},[s._v("6. Capabilities")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#7-netnamespace"}},[s._v("7. NetNamespace")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#8-route_localnet"}},[s._v("8. route_localnet")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#9-%E6%9C%AC%E5%9C%B0%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6"}},[s._v("9. 本地敏感文件")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#10-cgroup"}},[s._v("10. cgroup")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#11-aslr"}},[s._v("11. ASLR")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#12-%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3"}},[s._v("12. 开放端口")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#13-etchosts"}},[s._v("13. /etc/hosts")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#14-%E9%9B%86%E7%BE%A4%E7%9B%B8%E5%85%B3%E7%9A%84%E4%BF%A1%E6%81%AF"}},[s._v("14. 集群相关的信息")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#141-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E4%BF%A1%E6%81%AF"}},[s._v("14.1. 命名空间信息")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#142-service-account%E4%BF%A1%E6%81%AF"}},[s._v("14.2. Service Account信息")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#143-master%E8%8A%82%E7%82%B9ip"}},[s._v("14.3. Master节点ip")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#144-%E5%86%85%E7%BD%91%E6%8E%A2%E6%B5%8B"}},[s._v("14.4. 内网探测")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#15-%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"}},[s._v("15. 是否存在常用命令")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#16-%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%B8%BA%E5%AE%B9%E5%99%A8%E7%8E%AF%E5%A2%83"}},[s._v("16. 判断是否为容器环境")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#17-%E5%8F%82%E8%80%83"}},[s._v("17. 参考")])])])])]),s._v(" "),t("p",[s._v("主要目的： 建立对目标环境的感性认识，探寻脆弱点")]),s._v(" "),t("h2",{attrs:{id:"_1-基础系统信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-基础系统信息"}},[s._v("#")]),s._v(" 1. 基础系统信息")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("SYSINFO                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 基础系统信息                                        \n"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PWD")]),s._v("                       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /                                                  \n"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("                      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Current User: root  Uid: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  Gid: "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  GroupIds: "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nHome Dir                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /root                                            \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v("                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" d3012172604c                                     \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("uptime")]),s._v("                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 12h2m37.464537839s                               \nprocs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("                                                \nos                        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" linux                                            \nplatform                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" ubuntu                                           \nplatformFamily            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" debian                                           \nplatformVersion           "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20.04")]),s._v("                                            \nkernelVersion             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.15")]),s._v(".0-52-generic                                \nkernelArch                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" x86_64                                           \nvirtualizationSystem      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" kvm                                              \nvirtualizationRole        "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v("                                             \nhostId                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 00464d56-b2ad-124e-8111-b708436c4190             \ncpu name                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" AMD Ryzen "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" 5600G with Radeon Graphics           \ncpu nums                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 8c8t                                             \nmemory                    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" GB                                            \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h2",{attrs:{id:"_2-磁盘及挂载信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-磁盘及挂载信息"}},[s._v("#")]),s._v(" 2. 磁盘及挂载信息")]),s._v(" "),t("ul",[t("li",[s._v("/etc/mtab")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("DISKINFO                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" 磁盘信息\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" system               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" total    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" used percent "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Mount point     \noverlay                   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("209")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("68.79")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /               \ntmpfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67")]),s._v(" MB    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /dev            \nshm                       "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67")]),s._v(" MB    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /dev/shm        \n/dev/mapper/vgubuntu-root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("209")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("68.79")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /build          \n/dev/mapper/vgubuntu-root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("209")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("68.79")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /etc/resolv.conf\n/dev/mapper/vgubuntu-root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("209")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("68.79")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /etc/hostname   \n/dev/mapper/vgubuntu-root "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("209")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("68.79")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /etc/hosts      \ntmpfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.8")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /proc/asound    \ntmpfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.8")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /proc/acpi      \ntmpfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67")]),s._v(" MB    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /proc/kcore     \ntmpfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67")]),s._v(" MB    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /proc/keys      \ntmpfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67")]),s._v(" MB    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /proc/timer_list\ntmpfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.8")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /proc/scsi      \ntmpfs                     "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7.8")]),s._v(" GB   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /sys/firmware   \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("h2",{attrs:{id:"_3-是否为特权容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-是否为特权容器"}},[s._v("#")]),s._v(" 3. 是否为特权容器")]),s._v(" "),t("ul",[t("li",[s._v("/proc/self/status的capeff匹配到到3fffffffff")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('\tif strings.Contains(matched, "3fffffffff") {\n\t\t\tp.Result["CAP"] = append(p.Result["CAP"].([][]string), []string{"Privileged", "True"})\n\t\t\treturn true\n\t\t}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h2",{attrs:{id:"_4-sidfiles"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-sidfiles"}},[s._v("#")]),s._v(" 4. SidFiles")]),s._v(" "),t("ul",[t("li",[s._v("file.Mode()&os.ModeSetuid != 0\n"),t("ul",[t("li",[s._v("/usr/local/sbin")]),s._v(" "),t("li",[s._v("/usr/local/bin")]),s._v(" "),t("li",[s._v("/usr/sbin")]),s._v(" "),t("li",[s._v("/usr/bin")]),s._v(" "),t("li",[s._v("/sbin")]),s._v(" "),t("li",[s._v("/bin")]),s._v(" "),t("li",[s._v("/usr/games")]),s._v(" "),t("li",[s._v("/usr/local/games")]),s._v(" "),t("li",[s._v("/snap/bin")])])])]),s._v(" "),t("h2",{attrs:{id:"_5-环境变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-环境变量"}},[s._v("#")]),s._v(" 5. 环境变量")]),s._v(" "),t("ul",[t("li",[s._v("os.Environ()\n"),t("ul",[t("li",[s._v('"(?i)\\bssh_|k8s|kubernetes|docker|gopath"')])])])]),s._v(" "),t("h2",{attrs:{id:"_6-capabilities"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-capabilities"}},[s._v("#")]),s._v(" 6. Capabilities")]),s._v(" "),t("ul",[t("li",[s._v("/proc/self/status")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("CAP      | ---------------------------\n         | CapInh:      0000000000000000    \n         | CapPrm:      00000000a80425fb    \n         | CapEff:      00000000a80425fb    \n         | CapBnd:      00000000a80425fb    \n         | CapAmb:      0000000000000000  \nexp caps | CAP_DAC_READ_SEARCH,CAP_SYS_MODULE,CAP_SYS_ADMIN\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"_7-netnamespace"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_7-netnamespace"}},[s._v("#")]),s._v(" 7. NetNamespace")]),s._v(" "),t("ul",[t("li",[s._v("/proc/net/unix")]),s._v(" "),t("li",[s._v("--net=host\n"),t("ul",[t("li",[s._v("匹配/systemd/ 或 /run/user/")])])]),s._v(" "),t("li",[s._v("containerd-shim found\n"),t("ul",[t("li",[s._v("匹配到 `@/containerd-shim/[\\w\\d/-]*?.sock")])])])]),s._v(" "),t("h2",{attrs:{id:"_8-route-localnet"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_8-route-localnet"}},[s._v("#")]),s._v(" 8. route_localnet")]),s._v(" "),t("ul",[t("li",[s._v("/proc/sys/net/ipv4/conf/all/route_localnet = 1")])]),s._v(" "),t("h2",{attrs:{id:"_9-本地敏感文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_9-本地敏感文件"}},[s._v("#")]),s._v(" 9. 本地敏感文件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/docker.sock"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",     // "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" socket "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/containerd.sock"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(", // containerd socket "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("grpc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/containerd/s/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",   // containerd-shim socket "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("grpc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v(".kube/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v(".git/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v(".svn/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v(".pip/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/.bash_history"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/.bash_profile"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/.bashrc"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/.ssh/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v(".token"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/serviceaccount"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v(".dockerenv"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n"),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),s._v("/config.json"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v(",\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"_10-cgroup"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-cgroup"}},[s._v("#")]),s._v(" 10. cgroup")]),s._v(" "),t("ul",[t("li",[s._v("cat /proc/self/cgroup")]),s._v(" "),t("li",[s._v("cat /proc/1/cgroup")])]),s._v(" "),t("h2",{attrs:{id:"_11-aslr"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_11-aslr"}},[s._v("#")]),s._v(" 11. ASLR")]),s._v(" "),t("ul",[t("li",[s._v("ASLR off: /proc/sys/kernel/randomize_va_space = 0")])]),s._v(" "),t("h2",{attrs:{id:"_12-开放端口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_12-开放端口"}},[s._v("#")]),s._v(" 12. 开放端口")]),s._v(" "),t("ul",[t("li",[s._v("/proc/net/tcp")]),s._v(" "),t("li",[s._v("/proc/net/udp")])]),s._v(" "),t("h2",{attrs:{id:"_13-etc-hosts"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_13-etc-hosts"}},[s._v("#")]),s._v(" 13. /etc/hosts")]),s._v(" "),t("h2",{attrs:{id:"_14-集群相关的信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_14-集群相关的信息"}},[s._v("#")]),s._v(" 14. 集群相关的信息")]),s._v(" "),t("h3",{attrs:{id:"_14-1-命名空间信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_14-1-命名空间信息"}},[s._v("#")]),s._v(" 14.1. 命名空间信息")]),s._v(" "),t("h3",{attrs:{id:"_14-2-service-account信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_14-2-service-account信息"}},[s._v("#")]),s._v(" 14.2. Service Account信息")]),s._v(" "),t("ul",[t("li",[s._v("cat /var/run/secrets/kubernetes.io/serviceaccount/namespace")])]),s._v(" "),t("h3",{attrs:{id:"_14-3-master节点ip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_14-3-master节点ip"}},[s._v("#")]),s._v(" 14.3. Master节点ip")]),s._v(" "),t("h3",{attrs:{id:"_14-4-内网探测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_14-4-内网探测"}},[s._v("#")]),s._v(" 14.4. 内网探测")]),s._v(" "),t("h2",{attrs:{id:"_15-是否存在常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_15-是否存在常用命令"}},[s._v("#")]),s._v(" 15. 是否存在常用命令")]),s._v(" "),t("ul",[t("li",[s._v("exec.LookPath(cmd)\n"),t("ul",[t("li",[s._v("kubectl,ruby,python2,java,yum,httpd,base64,python3,g++,apache2,apt,apache,wget,ps,python,perl,node,php,docker,svn,fdisk,xterm,npm,ssh,sudo,curl,py,vi,python2.7,git,find,mount,capsh,dpkg,make,netcat,nginx,gcc,mysql-client,nc,mysql")])])])]),s._v(" "),t("h2",{attrs:{id:"_16-判断是否为容器环境"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_16-判断是否为容器环境"}},[s._v("#")]),s._v(" 16. 判断是否为容器环境")]),s._v(" "),t("ol",[t("li",[s._v("检查/.dockerenv文件是否存在")]),s._v(" "),t("li",[s._v('检查/proc/1/cgroup内是否包含"docker"等字符串')]),s._v(" "),t("li",[s._v("检查是否存在container环境变量")]),s._v(" "),t("li",[s._v("hostname是否为06e33f788f23格式")]),s._v(" "),t("li",[s._v("进程数量")])]),s._v(" "),t("h2",{attrs:{id:"_17-参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_17-参考"}},[s._v("#")]),s._v(" 17. 参考")]),s._v(" "),t("ul",[t("li",[s._v("https://mp.weixin.qq.com/s/_GwGS0cVRmuWEetwMesauQ")]),s._v(" "),t("li",[s._v("https://github.com/cdk-team/CDK/tree/main/pkg/evaluate")])])])}),[],!1,null,null,null);a.default=e.exports}}]);